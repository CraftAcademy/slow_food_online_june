= form_for([@menu, @dish], html: {multipart: true}) do |f|
  .field
    = f.label :category, 'Select the category for your dish'
    = f.select(:category, options_for_select(Dish::CATEGORIES),
                                              include_blank: 'Select category')
  .field
    = f.label :name
    = f.text_field :name
  .field
    = f.label :description
    = f.text_area :description
  .field
    = f.label :price
    = f.text_field :price
  .field
    = f.label :allergy_info
    = f.text_area :allergy_info
  .field
    = f.label :ingredients
    = f.text_area :ingredients
  .field
    = f.label :calories
    = f.number_field :calories
  .field
    = f.label :image
    - if @dish.image?
      = image_tag(@dish.image_url)
    - else
      = image_tag('#', id: 'preview', style: 'display: none;')
    = f.file_field :image, onchange: 'readAndPreviewImage(this);'
  .actions
    = f.submit 'Create'
  :javascript
    function readAndPreviewImage(input) {
          if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onload = function (e) {
              $('#preview')
                .css('display', 'inline-block')
                .attr('src', e.target.result);
            };
            reader.readAsDataURL(input.files[0]);
          }
        }
